{
    "contents" : "# Create calendar files\nlibrary(lubridate)\nlibrary(dplyr)\nlibrary(stringr)\ngenerate.dates <- function(first,last,holidays,location,weekdays,start.time,duration,type=\"Lecture\") {\n  dates <- c(first+c(0:(last-first))*days(1))\n  dates <- dates[wday(dates,label=TRUE,abbr=FALSE) %in% weekdays ]\n  dates <- dates[!(dates %in% holidays)]\n  hour(dates) <- hour(start.time)\n  minute(dates) <- minute(start.time)\n  end.dates <- dates + duration\n  data.frame(type=type,weekday=wday(dates,label=TRUE,abbr=FALSE), start.date=dates,end.date=end.dates,location=location)\n}\n\nfirst.teaching.date <- dmy(\"2-Mar-2015\", tz=Sys.timezone()) \nlast.teaching.date <- dmy(\"5-Jun-2015\", tz=Sys.timezone()) \nmidterm.1 <- dmy(\"3-Apr-2015\", tz=Sys.timezone()) + days(seq(0,(dmy(\"19-Apr-2015\", tz=Sys.timezone())-dmy(\"3-Apr-2015\", tz=Sys.timezone()))))\nlecture.location <- \"New Kirk KKLT301\" \nlecture.weekdays <- c(\"Tuesday\") \nlecture.duration <- new_duration(minute=50) \nholidays <- c(dmy(c(\"3-Apr-2015\",\"27-Apr-2015\",\"1-Jun-2015\"), tz=Sys.timezone()), midterm.1) # Good Friday, Anzac day, Queen's Birthday, midterm break\nstart.time <- hm(\"14:10\")\n\nlecture.dates <- generate.dates(first.teaching.date,last.teaching.date,holidays,lecture.location,lecture.weekdays,start.time,lecture.duration,type=\"Lecture\")\n\nlecture.location <- \"Maclaurin MCLT103\" \nlecture.weekdays <- c(\"Friday\") \n\nlecture.dates.2 <- generate.dates(first.teaching.date,last.teaching.date,holidays,lecture.location,lecture.weekdays,start.time,lecture.duration,type=\"Lecture\")\n\nfirst.teaching.date <- dmy(\"2-Mar-2015\", tz=Sys.timezone()) + weeks(1)\ntutorial.location <- \"KK105\"\ntutorial.weekdays <- c(\"Monday\")\nstart.time <- hm(\"15:10\")\n\ntutorial.dates <- generate.dates(first.teaching.date,last.teaching.date,holidays,tutorial.location,tutorial.weekdays,start.time,lecture.duration,type=\"Tutorials\")\n\ntutorial.location <- \"M303\"\ntutorial.weekdays <- c(\"Tuesday\")\nstart.time <- hm(\"13:10\")\n\ntutorial.dates.2 <- generate.dates(first.teaching.date,last.teaching.date,holidays,tutorial.location,tutorial.weekdays,start.time,lecture.duration,type=\"Tutorials\")\n\npols209.dates <- rbind(lecture.dates,lecture.dates.2,tutorial.dates,tutorial.dates.2)\n\n#Google fields: Subject,Start Date,Start Time,End Date,End Time,All Day Event,Description,Location,Private\n\ngoogle.calendar.file <- pols209.dates %>% \n  select(type,start.date,end.date,location) %>%\n  mutate(start.time = stamp(\" 15:00\")(start.date),\n         end.time = stamp(\" 15:00\")(end.date),\n         start.date = stamp(\"31/12/1999\")(start.date),\n         end.date = stamp(\"31/12/1999\")(end.date)) %>%\n  select(type,start.date,start.time,end.date,end.time,location)\n\n\nnames(google.calendar.file) <- c(\"Subject\",\"Start Date\",\"Start Time\",\"End Date\",\"End Time\",\"Location\")\n\nwrite.csv(google.calendar.file,\"google.calendar.file.csv\",row.names=FALSE)\n",
    "created" : 1425177335253.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "4|102|12|0|\n",
    "hash" : "483044092",
    "id" : "C2F81E98",
    "lastKnownWriteTime" : 1425179233,
    "path" : "~/Dropbox/Pols 209/xmarquez.github.io/trimester-date-generator.R",
    "project_path" : "trimester-date-generator.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}